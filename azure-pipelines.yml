trigger:
  branches:
    include:
      - withapi

pr:
  branches:
    include:
      - "*"

pool:
  vmImage: "windows-latest"

steps:
  - checkout: self
    persistCredentials: true

  - task: CmdLine@2
    inputs:
      script: |
        git clone https://github.com/simplic/documentation -b withapi

  - task: UsePythonVersion@0
    inputs:
      versionSpec: "3.8.5"
    displayName: "Use Python $(python.version)"

  - task: CmdLine@2
    inputs:
      script: |
        git config --system core.longpaths true
        cd documentation
        cd dev
        cd build
        pip install -r requirements.txt
        choco install docfx -y
        python build.py --git-user $(git_user) --git-pass $(git_pass) --ftp-user $(ftp_user) --ftp-pass $(ftp_pass)
